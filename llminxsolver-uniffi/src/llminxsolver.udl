namespace llminxsolver {
    void set_data_directory(string path);
    f64 calculate_mcc(string sequence);
    u32 get_move_count(string algorithm, string metric);
    u32 get_available_cpus();
    u32 get_available_memory_mb();
    u8 get_default_pruning_depth();
    u8 get_min_pruning_depth();
    u8 get_max_pruning_depth();
    string? validate_megaminx_state(MegaminxState state);
    void cleanup_stale_temp_files();
    ThemeColors? generate_theme_from_image(string image_path, boolean dark_theme, SchemeType scheme_type);
    ThemeColors? generate_theme_from_wallpaper(boolean dark_theme, SchemeType scheme_type);
    string? detect_wallpaper_path();
    string? export_scored_xlsx(
        string output_path,
        sequence<ScoredSolutionExport> solutions,
        sequence<u8>? image_png_bytes,
        u32 image_size
    );
    string? export_raw_xlsx(
        string output_path,
        sequence<string> algorithms,
        sequence<u8>? image_png_bytes,
        u32 image_size
    );
    string? export_raw_xlsx_from_file(
        string output_path,
        string solutions_file_path,
        sequence<u8>? image_png_bytes,
        u32 image_size
    );
};

[Enum]
interface SchemeType {
    TonalSpot();
    Content();
    Expressive();
    Fidelity();
    FruitSalad();
    Monochrome();
    Neutral();
    Rainbow();
    Vibrant();
};

dictionary ThemeColors {
    string primary;
    string on_primary;
    string primary_container;
    string on_primary_container;
    string secondary;
    string on_secondary;
    string secondary_container;
    string on_secondary_container;
    string tertiary;
    string on_tertiary;
    string tertiary_container;
    string on_tertiary_container;
    string error;
    string on_error;
    string error_container;
    string on_error_container;
    string background;
    string on_background;
    string surface;
    string on_surface;
    string surface_variant;
    string on_surface_variant;
    string outline;
    string outline_variant;
    string inverse_surface;
    string inverse_on_surface;
    string inverse_primary;
    string surface_tint;
    string surface_dim;
    string surface_bright;
    string surface_container_lowest;
    string surface_container_low;
    string surface_container;
    string surface_container_high;
    string surface_container_highest;
};

dictionary ScoredSolutionExport {
    f64 mcc;
    u32 move_count;
    string algorithm;
};

[Enum]
interface SearchMode {
    RU();
    RUF();
    RUL();
    RUFL();
    RUFLbL();
    RUbL();
    RUbR();
    RUD();
};

[Enum]
interface Metric {
    Face();
    Fifth();
};

dictionary ParallelConfig {
    u32 memory_budget_mb;
    u32 table_gen_threads;
    u32 search_threads;
};

dictionary SolverConfig {
    SearchMode search_mode;
    Metric metric;
    boolean limit_search_depth;
    u32 max_search_depth;
    u8 pruning_depth;
    boolean ignore_corner_positions;
    boolean ignore_edge_positions;
    boolean ignore_corner_orientations;
    boolean ignore_edge_orientations;
    ParallelConfig? parallel_config;
};

dictionary ModePruningDepth {
    SearchMode mode;
    u8 depth;
};

dictionary ParallelSolverConfig {
    sequence<SearchMode> search_modes;
    Metric metric;
    boolean limit_search_depth;
    u32 max_search_depth;
    u8 pruning_depth;
    sequence<ModePruningDepth> mode_pruning_depths;
    boolean ignore_corner_positions;
    boolean ignore_edge_positions;
    boolean ignore_corner_orientations;
    boolean ignore_edge_orientations;
    ParallelConfig parallel_config;
};

dictionary MegaminxState {
    sequence<u8> corner_positions;
    sequence<u8> corner_orientations;
    sequence<u8> edge_positions;
    sequence<u8> edge_orientations;
};

dictionary ProgressEvent {
    string event_type;
    string message;
    f64 progress;
    string? search_mode;
    u32 current_depth;
};

callback interface SolverCallback {
    void on_progress(ProgressEvent event);
    void on_solution_found(string solution);
    void on_complete();
};

interface SolverHandle {
    constructor(SolverConfig config, MegaminxState state);
    void set_callback(SolverCallback callback);
    void start();
    void cancel();
    boolean is_running();
};

interface ParallelSolverHandle {
    constructor(ParallelSolverConfig config, MegaminxState state);
    void set_callback(SolverCallback callback);
    void start();
    void cancel();
    boolean is_running();
};

interface TempFile {
    constructor();
    string? append(string solution);
    string get_path();
    u64 count();
    void flush_file();
    void delete_file();
    sequence<string> read_page(u64 offset, u64 limit);
};
